this is modified version of clode from original master
